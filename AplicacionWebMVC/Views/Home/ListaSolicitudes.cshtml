@model PagedList.IPagedList<AplicacionWebMVC.Models.Solicitud_Requisiciones>
@using PagedList.Mvc;
@{
    ViewBag.Title = "ListaSolicitudes";
}
@section Scripts{
    <script type="text/javascript">

        $(window).load(function () {
            setTimeout(function () {
                $(".loader").fadeOut(100);
            }, 1000);
        });
    </script>
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/themes/base/jquery-ui.css")" />
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/jquery.jqGrid/ui.jqgrid.css")" />
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/css/Main.css")" />
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/css/gridDetalle.css")" />
    <script type="text/javascript" src="@Url.Content("~/Scripts/i18n/grid.locale-en.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/jquery-ui-1.10.0.min.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/js/detalleRequisicion.js")"></script>
}

@if (!User.Identity.IsAuthenticated)
{
    Response.Redirect("~/Home/Index");
}
<div class="loader"></div>
<div id="solicitudURL" data-request-url="@Url.Action("GetSolicitud", "Home")"></div>
<h2>Lista de solicitudes</h2>
<table class="table">
    <tr>
        <th>
            PreRequisición
        </th>
        <th>
            Departamento
        </th>
        <th>
            Uso
        </th>
        <th>
            Observaciones
        </th>
        <th>
            Ciclo
        </th>
        <th>
            Area
        </th>
        <th>
            Local
        </th>
        <th>
            Capital Humano
        </th>
        <th>
            Electrico
        </th>
        <th>
            Seguridad
        </th>
        <th>
            Almacen
        </th>
        <th>
            Detalle
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
    <tr>
        <td>
            
            @Html.DisplayFor(modeltem => item.preRequisicion)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Departamentos.idDepartamento)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.uso)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.observaciones)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ciclo)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.area)
        </td>
        <td>
            
            @if(item.liberaLocal == "P")
            {
                <p>Pendiente</p>
            }else if(item.liberaLocal == "A")
            {
                <p>Aprobado</p>
            }else if(item.liberaLocal == "N")
            {
                <p>Rechazado</p>
            }
            else {
                <p>Desconocido</p>
            }
        </td>
        <td>
            @if(item.liberaCapitalHumano == "P")
            {
                <p>Pendiente</p>
            }else if(item.liberaCapitalHumano == "A")
            {
                <p>Aprobado</p>
            }else if(item.liberaCapitalHumano == "N")
            {
                <p>Rechazado</p>
            }
            else {
                <p>Desconocido</p>
            }
        </td>
        <td>
            @if(item.liberaElectrico == "P")
            {
                <p>Pendiente</p>
            }else if(item.liberaElectrico == "A")
            {
                <p>Aprobado</p>
            }else if(item.liberaElectrico == "N")
            {
                <p>Rechazado</p>
            }
            else {
                <p>Desconocido</p>
            }
        </td>
        <td>
            @if(item.liberaSeguridad == "P")
            {
                <p>Pendiente</p>
            }else if(item.liberaSeguridad == "A")
            {
                <p>Aprobado</p>
            }else if(item.liberaSeguridad == "N")
            {
                <p>Rechazado</p>
            }
            else {
                <p>Desconocido</p>
            }
        </td>
        <td>
            @if(item.liberaAlmacen == "P")
            {
                <p>Pendiente</p>
            }else if(item.liberaAlmacen == "A")
            {
                <p>Aprobado</p>
            }else if(item.liberaAlmacen == "N")
            {
                <p>Rechazado</p>
            }
            else {
                <p>Desconocido</p>
            }
        </td>
        <td>
            <button class="btn btn-success glyphicon glyphicon-info-sign" style="margin: auto;display: block;" onclick="@("abrirDetalle('"+item.preRequisicion+"','"+item.departamento+"','"+item.ejercicio+"','"+item.uso+ "','" + item.ciclo + "')")"></button>
        </td>
    </tr>
    }

</table>
    Pagina @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) de @Model.PageCount

    @Html.PagedListPager(Model, page => Url.Action("Revision", new { page, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter }))

    <div id="modalDetalle" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Detalle</h4>
                </div>
                <div class="modal-body modalD">
                    <div class="loaderD"></div>
                    <div id="divD" style="display:none;">
                        <label for="lblPreReq">PreRequisicion :</label>
                        <p id="lblPreReq"></p>
                        <label for="lblUsoR">Uso :</label>
                        <p id="lblUsoR"></p>
                        <label for="lblCiclo">Ciclo :</label>
                        <p id="lblCiclo"></p>
                        <table id="gridDet"></table>
                        <div id="pagerDet"></div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>

        </div>
    </div>
